services:
  data_service:
    build:
      context: .
      containerfile: Containerfile.data
    image: cosmic_explorer_data
    volumes:
      - ./data:/workspace/data
      - ./scripts:/workspace/scripts:ro
      - ./requirements.txt:/workspace/requirements.txt:ro
      - ./desktop_app:/workspace/desktop_app:ro
    environment:
      - PYTHONUNBUFFERED=1
      - MPLBACKEND=Agg
      - PYTHONPATH=/workspace
    stdin_open: true
    tty: true

  desktop_app:
    build:
      context: .
      containerfile: Containerfile.desktop
    image: cosmic_explorer_desktop
    volumes:
      - ./data:/workspace/data
      - ./desktop_app:/workspace/desktop_app:ro
      - ./scripts:/workspace/scripts:ro
      - ./requirements.txt:/workspace/requirements.txt:ro
    environment:
      - PYTHONPATH=/workspace
      - LIBGL_ALWAYS_INDIRECT=1
    stdin_open: true
    tty: true
    ports:
      - "5900:5900"  # VNC port for GUI access

  web_portal:
    build:
      context: .
      containerfile: Containerfile.web
    image: cosmic_explorer_web
    ports:
      - "3000:3000"
    volumes:
      - ./data/processed:/app/public/data:ro
      - ./web_portal:/app/web_portal:ro
    stdin_open: true
    tty: true
